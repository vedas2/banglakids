<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bangla Kids Game - With Rewards</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #e0f7fa;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            user-select: none;
        }

        .game-container {
            width: 90%;
            max-width: 400px;
            height: 650px;
            background: white;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
            text-align: center;
            display: flex;
            flex-direction: column;
        }

        /* --- UI Elements --- */
        .progress-bar { height: 6px; background: #eee; width: 100%; }
        .progress-fill { height: 100%; background: #4ecdc4; width: 0%; transition: width 0.5s; }
        
        .level-indicator {
            padding: 10px; font-size: 0.9rem; color: #888;
            font-weight: bold; text-transform: uppercase;
        }

        .nav-dots {
            position: absolute; bottom: 25px; width: 100%;
            display: flex; justify-content: center; gap: 12px; z-index: 10;
        }
        .dot { width: 10px; height: 10px; background: #e0e0e0; border-radius: 50%; transition: all 0.3s; }
        .dot.active { background: #ff6b6b; transform: scale(1.3); }

        /* --- Buttons --- */
        .btn-main {
            margin-top: auto; margin-bottom: 70px; padding: 14px 0;
            font-size: 1.3rem; background-color: #4ecdc4; color: white;
            border: none; border-radius: 30px; cursor: pointer; width: 85%;
            align-self: center; font-weight: bold; box-shadow: 0 4px 0 #3db9b0;
            transition: transform 0.1s, box-shadow 0.1s;
            z-index: 5;
        }
        .btn-main:active { transform: translateY(4px); box-shadow: none; }
        
        .btn-secondary {
            background: #ff6b6b; padding: 8px 20px; color: white;
            border: none; border-radius: 15px; cursor: pointer;
            box-shadow: 0 3px 0 #e55a5a;
        }

        /* --- Screens --- */
        .screen {
            display: none; flex-direction: column; align-items: center;
            justify-content: center; height: 100%; padding: 20px;
            animation: slideIn 0.4s ease-out; width: 100%; box-sizing: border-box;
        }
        .screen.active { display: flex; }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        /* --- Screen 1: Animation --- */
        .big-letter {
            font-size: 11rem; color: #ff6b6b; cursor: pointer;
            text-shadow: 2px 2px 0px #eee;
        }
        .bouncing { animation: bounce 2s infinite; }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-20px);}
            60% {transform: translateY(-10px);}
        }

        /* --- Screen 2: Association --- */
        .word-card {
            background: #fff9c4; padding: 30px; border-radius: 20px;
            border-bottom: 6px solid #fbc02d; width: 80%;
        }
        .emoji-img { font-size: 6rem; display: block; margin-bottom: 15px; }
        .word-text { font-size: 3rem; color: #333; font-weight: bold; }
        .highlight { color: #ff6b6b; }
        .sub-text { color: #777; font-size: 1.1rem; margin-top: 5px; }

        /* --- Screen 3: Tracing --- */
        .canvas-wrapper {
            position: relative; width: 280px; height: 280px;
            border: 3px dashed #bbb; border-radius: 15px;
            margin-bottom: 15px; background: #fff;
        }
        .trace-guide {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -55%);
            font-size: 10rem; color: #e0e0e0; pointer-events: none;
        }
        canvas { position: absolute; top: 0; left: 0; cursor: crosshair; touch-action: none; }

        /* --- Screen 4: Reward --- */
        .star-container { font-size: 5rem; margin-bottom: 20px; }
        .star { display: inline-block; animation: pop 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; opacity: 0; transform: scale(0); }
        .star:nth-child(1) { animation-delay: 0.1s; color: gold; }
        .star:nth-child(2) { animation-delay: 0.3s; color: orange; font-size: 7rem; }
        .star:nth-child(3) { animation-delay: 0.5s; color: gold; }
        
        @keyframes pop {
            to { opacity: 1; transform: scale(1); }
        }

        .reward-text { font-size: 3rem; color: #4ecdc4; font-weight: bold; margin-bottom: 10px; }
        
        /* Confetti */
        .confetti {
            position: absolute; width: 10px; height: 10px; background: red;
            animation: fall linear forwards;
        }
        @keyframes fall { to { transform: translateY(700px) rotate(720deg); } }

    </style>
</head>
<body>

<div class="game-container" id="gameBox">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="level-indicator" id="levelIndicator">Level 1: Letter ‡¶Ö</div>

    <div class="screen active" id="s1">
        <div style="color:#888; margin-bottom: 20px;">Tap to hear sound</div>
        <div class="big-letter bouncing" id="animLetter" onclick="playSound()"></div>
        <button class="btn-main" onclick="goToStep(2)">Learn Word</button>
    </div>

    <div class="screen" id="s2">
        <div class="word-card">
            <span class="emoji-img" id="wordEmoji"></span>
            <div class="word-text" id="wordText"></div>
            <div class="sub-text" id="wordMeaning"></div>
        </div>
        <button class="btn-main" onclick="goToStep(3)">Let's Write!</button>
    </div>

    <div class="screen" id="s3">
        <div style="color:#666; margin-bottom: 10px;">Trace the Letter</div>
        <div class="canvas-wrapper">
            <div class="trace-guide" id="traceLetter"></div>
            <canvas id="traceCanvas" width="280" height="280"></canvas>
        </div>
        <button class="btn-secondary" onclick="clearCanvas()">Erase</button>
        <button class="btn-main" style="margin-top: 20px; background:#4CAF50;" onclick="showReward()">Done!</button>
    </div>

    <div class="screen" id="sReward">
        <div class="star-container">
            <span class="star">‚òÖ</span>
            <span class="star">‚òÖ</span>
            <span class="star">‚òÖ</span>
        </div>
        <div class="reward-text">‡¶∏‡¶æ‡¶¨‡¶æ‡¶∏!</div>
        <div style="color: #666; font-size: 1.2rem;">(Well Done!)</div>
        <button class="btn-main" id="nextLevelBtn" onclick="nextLetter()">Next Letter ‚ûú</button>
    </div>

    <div class="nav-dots" id="dotsNav">
        <div class="dot active" id="d1"></div>
        <div class="dot" id="d2"></div>
        <div class="dot" id="d3"></div>
    </div>
</div>

<script>
    const letters = [
        { 
            char: "‡¶Ö", 
            soundText: "Aw", 
            word: "‡¶Ö‡¶ú‡¶ó‡¶∞", 
            highlightIndex: 0, 
            meaning: "Ajogor (Python)", 
            emoji: "üêç" 
        },
        { 
            char: "‡¶Ü", 
            soundText: "Aa", 
            word: "‡¶Ü‡¶Æ", 
            highlightIndex: 0, 
            meaning: "Aam (Mango)", 
            emoji: "ü•≠" 
        },
        { 
            char: "‡¶á", 
            soundText: "Ee", 
            word: "‡¶á‡¶Å‡¶¶‡ßÅ‡¶∞", 
            highlightIndex: 0, 
            meaning: "Indur (Mouse)", 
            emoji: "üêÅ" 
        },
        { 
            char: "‡¶à", 
            soundText: "Eee", 
            word: "‡¶à‡¶¶", 
            highlightIndex: 0, 
            meaning: "Eid (Festival)", 
            emoji: "üåô" 
        },
        { 
            char: "‡¶â", 
            soundText: "U", 
            word: "‡¶â‡¶ü", 
            highlightIndex: 0, 
            meaning: "Ut (Camel)", 
            emoji: "üê™" 
        },
        { 
            char: "‡¶ä", 
            soundText: "Uuu", 
            word: "‡¶ä‡¶∑‡¶æ", 
            highlightIndex: 0, 
            meaning: "Usha (Dawn)", 
            emoji: "üåÖ" 
        },
        { 
            char: "‡¶ã", 
            soundText: "Ri", 
            word: "‡¶ã‡¶§‡ßÅ", 
            highlightIndex: 0, 
            meaning: "Ritu (Season)", 
            emoji: "üåßÔ∏è" 
        },
        { 
            char: "‡¶è", 
            soundText: "A", 
            word: "‡¶è‡¶ï‡¶§‡¶æ‡¶∞‡¶æ", 
            highlightIndex: 0, 
            meaning: "Ektara (Instrument)", 
            emoji: "üé∏" 
        },
        { 
            char: "‡¶ê", 
            soundText: "Oi", 
            word: "‡¶ê‡¶∞‡¶æ‡¶¨‡¶§", 
            highlightIndex: 0, 
            meaning: "Oirabot (Elephant)", 
            emoji: "üêò" 
        },
        { 
            char: "‡¶ì", 
            soundText: "O", 
            word: "‡¶ì‡¶≤‡¶ï‡¶™‡¶ø", 
            highlightIndex: 0, 
            meaning: "Olkopi (Turnip/Kohlrabi)", 
            emoji: "ü•¨" 
        },
        { 
            char: "‡¶î", 
            soundText: "Ou", 
            word: "‡¶î‡¶∑‡¶ß", 
            highlightIndex: 0, 
            meaning: "Oushodh (Medicine)", 
            emoji: "üíä" 
        }
    ];

    let currentLetterIndex = 0;

    window.onload = function() { loadLetterData(0); };

    function loadLetterData(index) {
        const data = letters[index];
        document.getElementById('levelIndicator').innerText = `Level ${index + 1}: Letter ${data.char}`;
        document.getElementById('animLetter').innerText = data.char;
        document.getElementById('wordEmoji').innerText = data.emoji;
        
        let htmlWord = "";
        for(let i=0; i<data.word.length; i++) {
            if(i === data.highlightIndex) htmlWord += `<span class="highlight">${data.word[i]}</span>`;
            else htmlWord += data.word[i];
        }
        document.getElementById('wordText').innerHTML = htmlWord;
        document.getElementById('wordMeaning').innerText = data.meaning;
        document.getElementById('traceLetter').innerText = data.char;
        
        updateProgress(0);
        document.getElementById('dotsNav').style.display = 'flex'; // Show dots
    }

    function goToStep(stepNum) {
        // Hide all screens
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.dot').forEach(d => d.classList.remove('active'));

        document.getElementById('s' + stepNum).classList.add('active');
        if(stepNum <= 3) document.getElementById('d' + stepNum).classList.add('active');

        if(stepNum === 1) updateProgress(10);
        if(stepNum === 2) updateProgress(50);
        if(stepNum === 3) updateProgress(80);
    }

    function showReward() {
        // Hide dots during reward
        document.getElementById('dotsNav').style.display = 'none'; 
        
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById('sReward').classList.add('active');
        
        updateProgress(100);
        createConfetti();

        const btn = document.getElementById('nextLevelBtn');
        if (currentLetterIndex < letters.length - 1) {
            btn.innerText = "Next Letter ‚ûú";
            btn.onclick = nextLetter;
        } else {
            btn.innerText = "Restart Game ‚Ü∫";
            btn.onclick = () => location.reload();
        }
    }

    function nextLetter() {
        if (currentLetterIndex < letters.length - 1) {
            currentLetterIndex++;
            clearCanvas();
            loadLetterData(currentLetterIndex);
            goToStep(1);
        }
    }

    function updateProgress(percent) {
        document.getElementById('progressFill').style.width = percent + "%";
    }

    function playSound() {
        const data = letters[currentLetterIndex];
        if ('speechSynthesis' in window) {
            let msg = new SpeechSynthesisUtterance();
            msg.text = data.soundText; 
            msg.rate = 0.8; 
            window.speechSynthesis.speak(msg);
        }
        const el = document.getElementById('animLetter');
        el.classList.remove('bouncing');
        void el.offsetWidth;
        el.classList.add('bouncing');
    }

    // --- Simple Confetti Effect ---
    function createConfetti() {
        const colors = ['#ff6b6b', '#4ecdc4', '#fbc02d', '#45b7d1'];
        const container = document.getElementById('gameBox');
        
        for (let i = 0; i < 30; i++) {
            const confetti = document.createElement('div');
            confetti.classList.add('confetti');
            
            // Random positioning
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.top = '-10px';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.animationDuration = (Math.random() * 2 + 1) + 's'; // 1-3s fall
            
            container.appendChild(confetti);

            // Clean up
            setTimeout(() => { confetti.remove(); }, 3000);
        }
    }

    // --- Canvas Logic ---
    const canvas = document.getElementById('traceCanvas');
    const ctx = canvas.getContext('2d');
    let painting = false;

    ctx.lineWidth = 18; ctx.lineCap = 'round'; ctx.lineJoin = 'round'; ctx.strokeStyle = '#444';

    function startPosition(e) { painting = true; draw(e); }
    function finishedPosition() { painting = false; ctx.beginPath(); }
    function draw(e) {
        if (!painting) return;
        e.preventDefault();
        const rect = canvas.getBoundingClientRect();
        const clientX = e.touches ? e.touches[0].clientX : e.clientX;
        const clientY = e.touches ? e.touches[0].clientY : e.clientY;
        const x = clientX - rect.left;
        const y = clientY - rect.top;

        ctx.lineTo(x, y); ctx.stroke(); ctx.beginPath(); ctx.moveTo(x, y);
    }

    canvas.addEventListener('mousedown', startPosition);
    canvas.addEventListener('mouseup', finishedPosition);
    canvas.addEventListener('mousemove', draw);
    canvas.addEventListener('touchstart', startPosition);
    canvas.addEventListener('touchend', finishedPosition);
    canvas.addEventListener('touchmove', draw);

    function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }
</script>

</body>
</html>
